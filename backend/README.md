# OAManage V4 - ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ë°±ì—”ë“œ

TypeScript ê¸°ë°˜ ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸ì„ êµ¬í˜„í•œ ë°±ì—”ë“œ ì„œë²„ì…ë‹ˆë‹¤.

## ğŸ“‹ ê¸°ìˆ  ìŠ¤íƒ

- **Node.js**: 22.x
- **TypeScript**: 5.9.3
- **Express**: ì›¹ í”„ë ˆì„ì›Œí¬
- **Axios**: HTTP í´ë¼ì´ì–¸íŠ¸
- **express-session**: ì„¸ì…˜ ê´€ë¦¬
- **MySQL**: ë°ì´í„°ë² ì´ìŠ¤

## ğŸš€ ì‹œì‘í•˜ê¸°

### 1. ì˜ì¡´ì„± ì„¤ì¹˜

```bash
npm install
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

MySQLì„ ì„¤ì¹˜í•˜ê³  ì ‘ê·¼ ê°€ëŠ¥í•œ ê³„ì •ì„ ì¤€ë¹„í•˜ì„¸ìš”. ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹œì‘ë  ë•Œ `DB_NAME`ì— ì§€ì •í•œ ë°ì´í„°ë² ì´ìŠ¤ì™€ `users` í…Œì´ë¸”ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤. (ì´ˆê¸° ì„¤ì •ì´ ì˜ëª»ë˜ë©´ ì„œë²„ê°€ ì‹œì‘ë˜ì§€ ì•Šìœ¼ë‹ˆ, í™˜ê²½ ë³€ìˆ˜ë¥¼ ì •í™•íˆ ì…ë ¥í•˜ì„¸ìš”.)

### 3. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`.env` íŒŒì¼ì— ë‹¤ìŒ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”:

```env
# ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì„¤ì •
KAKAO_CLIENT_ID=ì—¬ê¸°ì—_REST_API_í‚¤_ì…ë ¥
KAKAO_REDIRECT_URI=http://localhost:3000/auth/kakao/callback

# ì„œë²„ ì„¤ì •
PORT=3000
SESSION_SECRET=ëœë¤í•œ_ì‹œí¬ë¦¿_í‚¤_ì…ë ¥
NODE_ENV=development

# í”„ë¡ íŠ¸ì—”ë“œ URL (CORSìš©)
FRONTEND_URL=http://localhost:3000

# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=ì—¬ê¸°ì—_MySQL_ë¹„ë°€ë²ˆí˜¸_ì…ë ¥
DB_NAME=oamanage
```

### 4. ì¹´ì¹´ì˜¤ ê°œë°œì ì„¤ì •

1. [ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†”](https://developers.kakao.com/)ì— ì ‘ì†
2. ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„±
3. **ì•± ì„¤ì • > í”Œë«í¼ ì„¤ì •**ì—ì„œ Web í”Œë«í¼ ì¶”ê°€
   - ì‚¬ì´íŠ¸ ë„ë©”ì¸: `http://localhost:3000`
4. **ì œí’ˆ ì„¤ì • > ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸**
   - ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í™œì„±í™”
   - Redirect URI: `http://localhost:3000/auth/kakao/callback` ë“±ë¡
5. **ì•± í‚¤**ì—ì„œ REST API í‚¤ ë³µì‚¬ â†’ `.env`ì˜ `KAKAO_CLIENT_ID`ì— ì…ë ¥

### 5. ê°œë°œ ì„œë²„ ì‹¤í–‰

```bash
# ê°œë°œìš© í•« ë¦¬ë¡œë“œ ì„œë²„
npm run dev

# ë˜ëŠ” ë¹Œë“œ í›„ í”„ë¡œë•ì…˜ ëª¨ë“œ ì‹¤í–‰
npm run build
npm run start
```

ì„œë²„ê°€ `http://localhost:3000`ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

## ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸

### ì¸ì¦ ê´€ë ¨

| Method | Endpoint | ì„¤ëª… | ì¸ì¦ í•„ìš” |
|--------|----------|------|-----------|
| GET | `/auth/kakao` | ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œì‘ | âŒ |
| GET | `/auth/kakao/callback` | ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì½œë°± | âŒ |
| GET | `/auth/me` | í˜„ì¬ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ | âœ… |
| POST | `/auth/logout` | ë¡œê·¸ì•„ì›ƒ | âœ… |

### ê¸°íƒ€

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | `/health` | í—¬ìŠ¤ ì²´í¬ |

## ğŸ” ì‚¬ìš© ë°©ë²•

### 1. ë¡œê·¸ì¸ ì‹œì‘

ë¸Œë¼ìš°ì €ì—ì„œ ë‹¤ìŒ URLë¡œ ì ‘ì†:
```
http://localhost:3000/auth/kakao
```

### 2. ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í˜ì´ì§€

ìë™ìœ¼ë¡œ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë©ë‹ˆë‹¤.

### 3. ë¡œê·¸ì¸ ì™„ë£Œ

ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ì„¤ì •í•œ í”„ë¡ íŠ¸ì—”ë“œ URLë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë©ë‹ˆë‹¤.
DBì— ì‚¬ìš©ì ì •ë³´ê°€ ì €ì¥ë˜ê³ , ì„¸ì…˜ì— ì‚¬ìš©ì ì •ë³´ê°€ ì €ì¥ë©ë‹ˆë‹¤.

### 4. ì‚¬ìš©ì ì •ë³´ í™•ì¸

```bash
curl http://localhost:3000/auth/me \
  -H "Cookie: connect.sid=YOUR_SESSION_ID"
```

ì‘ë‹µ ì˜ˆì‹œ:
```json
{
  "success": true,
  "data": {
    "id": 1,
    "kakaoId": "1234567890",
    "nickname": "í™ê¸¸ë™",
    "email": "user@example.com",
    "profileImage": "http://..."
  }
}
```

### 5. ë¡œê·¸ì•„ì›ƒ

```bash
curl -X POST http://localhost:3000/auth/logout \
  -H "Cookie: connect.sid=YOUR_SESSION_ID"
```

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
oamanagev4/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/                  # ì„¤ì •
â”‚   â”‚   â””â”€â”€ database.ts          # DB ì—°ê²° ì„¤ì •
â”‚   â”œâ”€â”€ controllers/             # ì»¨íŠ¸ë¡¤ëŸ¬
â”‚   â”‚   â””â”€â”€ auth.controller.ts
â”‚   â”œâ”€â”€ middleware/              # ë¯¸ë“¤ì›¨ì–´
â”‚   â”‚   â””â”€â”€ auth.middleware.ts
â”‚   â”œâ”€â”€ models/                  # DB ëª¨ë¸
â”‚   â”‚   â””â”€â”€ user.model.ts
â”‚   â”œâ”€â”€ routes/                  # ë¼ìš°íŠ¸
â”‚   â”‚   â””â”€â”€ auth.routes.ts
â”‚   â”œâ”€â”€ services/                # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â””â”€â”€ kakaoAuth.service.ts
â”‚   â”œâ”€â”€ types/                   # TypeScript íƒ€ì… ì •ì˜
â”‚   â”‚   â”œâ”€â”€ kakao.ts
â”‚   â”‚   â””â”€â”€ session.d.ts
â”‚   â”œâ”€â”€ app.ts                   # Express ì•± ì„¤ì •
â”‚   â””â”€â”€ server.ts                # ì„œë²„ ì§„ì…ì 
â”œâ”€â”€ database/                    # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”œâ”€â”€ schema.sql               # DB ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ init.sh                  # DB ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ .env                         # í™˜ê²½ ë³€ìˆ˜ (ì‹¤ì œ ê°’)
â”œâ”€â”€ .env.example                 # í™˜ê²½ ë³€ìˆ˜ ì˜ˆì‹œ
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”œâ”€â”€ nodemon.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ package.json
```

## ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### users í…Œì´ë¸”

| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | INT | ìë™ ì¦ê°€ PK |
| kakao_id | VARCHAR(100) | ì¹´ì¹´ì˜¤ ê³ ìœ  ID (UNIQUE) |
| nickname | VARCHAR(100) | ë‹‰ë„¤ì„ |
| email | VARCHAR(255) | ì´ë©”ì¼ (ì„ íƒ) |
| profile_image | VARCHAR(500) | í”„ë¡œí•„ ì´ë¯¸ì§€ URL (ì„ íƒ) |
| created_at | TIMESTAMP | ìƒì„± ì‹œê°„ |
| updated_at | TIMESTAMP | ìˆ˜ì • ì‹œê°„ |

## ğŸ”§ ë¹Œë“œ ë° ë°°í¬

### ë¹Œë“œ

```bash
npm run build
```

`dist/` í´ë”ì— ì»´íŒŒì¼ëœ JavaScript íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.

### í”„ë¡œë•ì…˜ ì‹¤í–‰

```bash
npm start
```

## ğŸ›¡ï¸ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **í™˜ê²½ ë³€ìˆ˜**: `.env` íŒŒì¼ì„ Gitì— ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš”
2. **ì„¸ì…˜ ì‹œí¬ë¦¿**: í”„ë¡œë•ì…˜ì—ì„œëŠ” ê°•ë ¥í•œ ëœë¤ ë¬¸ìì—´ ì‚¬ìš©
3. **HTTPS**: í”„ë¡œë•ì…˜ì—ì„œëŠ” ë°˜ë“œì‹œ HTTPS ì‚¬ìš©
4. **CORS**: ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë„ë©”ì¸ë§Œ í—ˆìš©
5. **ë°ì´í„°ë² ì´ìŠ¤**: í”„ë¡œë•ì…˜ì—ì„œëŠ” ë³„ë„ì˜ DB ì‚¬ìš©ì ìƒì„±

## ğŸ“ ì°¸ê³  ë¬¸ì„œ

- [ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ê°€ì´ë“œ](https://developers.kakao.com/docs/latest/ko/kakaologin/common)
- [Express ê³µì‹ ë¬¸ì„œ](https://expressjs.com/)
- [TypeScript ê³µì‹ ë¬¸ì„œ](https://www.typescriptlang.org/)
